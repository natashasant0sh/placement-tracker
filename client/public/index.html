<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Placement Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="container mx-auto px-4 py-8">
        <div id="root"></div>
    </div>
    <script>
        const root = document.getElementById('root');

        function renderLandingPage() {
            const landingPage = `
                <div class="text-center">
                    <h1 class="text-3xl font-bold mb-4">Placement Tracker</h1>
                    <a href="#" onclick="renderLoginForm()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">
                        Login
                    </a>
                    <a href="#" onclick="renderStudentSignupForm()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline ml-4">
                        Student Sign Up
                    </a>
                    <a href="#" onclick="renderPlacementOfficerSignupForm()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline ml-4">
                        Placement Officer Sign Up
                    </a>
                </div>
            `;
            root.innerHTML = landingPage;
        }

        function renderLoginForm() {
            const loginForm = `
                <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="username">
                            Username
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="username" type="text" placeholder="Enter Username">
                    </div>
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="password">
                            Password
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="password" type="password" placeholder="******************">
                    </div>
                    <div class="flex items-center justify-between">
                        <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="button" onclick="handleLogin()">
                            Login
                        </button>
                    </div>
                </div>
            `;
            root.innerHTML = loginForm;
        }

        function renderStudentSignupForm() {
            const signupForm = `
                <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="srn">
                            SRN
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="srn" type="text" placeholder="Enter SRN">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="name">
                            Name
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="name" type="text" placeholder="Enter Name">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="email">
                            Email
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="email" type="email" placeholder="Enter Email">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="cgpa">
                            CGPA
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="cgpa" type="number" placeholder="Enter CGPA">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="year_of_grad">
                            Year of Graduation
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="year_of_grad" type="number" placeholder="Enter Year of Graduation">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="phone">
                            Phone Number
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="phone" type="tel" placeholder="Enter Phone Number">
                    </div>
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="password">
                            Password
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="password" type="password" placeholder="******************">
                    </div>
                    <div class="flex items-center justify-between">
                        <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="button" onclick="handleStudentSignup()">
                            Sign Up
                        </button>
                        <a class="inline-block align-baseline font-bold text-sm text-blue-500 hover:text-blue-800" href="#" onclick="renderLandingPage()">
                            Back to Landing Page
                        </a>
                    </div>
                </div>
            `;
            root.innerHTML = signupForm;
        }

        function renderPlacementOfficerSignupForm() {
            const signupForm = `
                <div class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="officer_id">
                            Officer ID
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="officer_id" type="text" placeholder="Enter Officer ID">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="dept">
                            Department
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="dept" type="text" placeholder="Enter Department">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="name">
                            Name
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="name" type="text" placeholder="Enter Name">
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="email">
                            Email
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="email" type="email" placeholder="Enter Email">
                    </div>
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="password">
                            Password
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="password" type="password" placeholder="******************">
                    </div>
                    <div class="flex items-center justify-between">
                        <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="button" onclick="handlePlacementOfficerSignup()">
                            Sign Up
                        </button>
                        <a class="inline-block align-baseline font-bold text-sm text-blue-500 hover:text-blue-800" href="#" onclick="renderLandingPage()">
                            Back to Landing Page
                        </a>
                    </div>
                </div>
            `;
            root.innerHTML = signupForm;
        }

        function handleLogin() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            console.log("frontend user and pass");
            console.log(username, password);

            if (!username || !password) {
                Swal.fire({
                icon: 'error',
                title: 'Oops...',
                text: 'Please fill in all fields!',
                });
                return;
            }

            axios.post('/login', { username, password })
                .then(response => {
                console.log("Login Response:", response.data); 

                if (response.data.redirect) {
                    window.location.href = response.data.redirect;
                } else {
                    Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Invalid login response.'
                    });
                }
                })
                .catch(error => {
                console.error('Error during login:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Invalid username or password!',
                });
                });
        }

        function handleStudentSignup() {
            const srn = document.getElementById('srn').value;
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const cgpa = document.getElementById('cgpa').value;
            const year_of_grad = document.getElementById('year_of_grad').value;
            const phone = document.getElementById('phone').value;
            const password = document.getElementById('password').value;

            if (!srn || !name || !email || !cgpa || !year_of_grad || !phone || !password) {
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Please fill in all fields!',
                });
                return;
            }

            axios.post('/signup/student', { srn, name, email, cgpa, year_of_grad, phone, password })
                .then(response => {
                    Swal.fire({
                        icon: 'success',
                        title: 'Signup Successful!',
                        showConfirmButton: false,
                        timer: 1500
                    });
                    setTimeout(() => {
                        renderLandingPage();
                    }, 1500);
                })
                .catch(error => {
                    console.error('Error during signup:', error);
                    Swal.fire({
                        icon: 'error',
                        title: 'Oops...',
                        text: error.response.data.error,
                    });
                });
        }

        function handlePlacementOfficerSignup() {
            const officer_id = document.getElementById('officer_id').value;
            const dept = document.getElementById('dept').value;
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            if (!officer_id || !dept || !name || !email || !password) {
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'Please fill in all fields!',
                });
                return;
            }

            axios.post('/signup/placement_officer', { officer_id, dept, name, email, password })
                .then(response => {
                    Swal.fire({
                        icon: 'success',
                        title: 'Signup Successful!',
                        showConfirmButton: false,
                        timer: 1500
                    });
                    setTimeout(() => {
                        renderLandingPage();
                    }, 1500);
                })
                .catch(error => {
                    console.error('Error during signup:', error);
                    Swal.fire({
                        icon: 'error',
                        title: 'Oops...',
                        text: error.response.data.error,
                    });
                });
        }

        renderLandingPage();
    </script>
</body>
</html>